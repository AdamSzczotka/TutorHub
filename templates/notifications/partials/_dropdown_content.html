<div class="flex items-center justify-between mb-2">
    <h3 class="font-bold">Powiadomienia</h3>
    {% if unread_count > 0 %}
    <button class="btn btn-ghost btn-xs"
            hx-post="{% url 'notifications:mark_all_read' %}"
            hx-swap="none"
            hx-on::after-request="htmx.trigger(document.body, 'notificationsUpdated')">
        Oznacz wszystkie
    </button>
    {% endif %}
</div>

<div class="divide-y max-h-80 overflow-y-auto">
    {% if notifications %}
        {% for notification in notifications %}
        <a href="{{ notification.action_url|default:'#' }}"
           class="block py-3 px-1 hover:bg-base-200 transition-colors {% if not notification.is_read %}bg-primary/5{% endif %}"
           hx-post="{% url 'notifications:mark_read' notification.id %}"
           hx-swap="none">
            <div class="flex items-start gap-3">
                <div class="flex-shrink-0 mt-1">
                    {% if notification.type == 'MESSAGE' %}
                    <div class="w-8 h-8 rounded-full bg-info/20 flex items-center justify-center">
                        <svg class="w-4 h-4 text-info" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                        </svg>
                    </div>
                    {% elif notification.type == 'CANCELLATION' %}
                    <div class="w-8 h-8 rounded-full bg-warning/20 flex items-center justify-center">
                        <svg class="w-4 h-4 text-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    {% else %}
                    <div class="w-8 h-8 rounded-full bg-base-300 flex items-center justify-center">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                        </svg>
                    </div>
                    {% endif %}
                </div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium {% if not notification.is_read %}text-base-content{% else %}text-base-content/70{% endif %}">
                        {{ notification.title }}
                    </p>
                    <p class="text-xs text-base-content/60 truncate">
                        {{ notification.message|truncatewords:10 }}
                    </p>
                    <p class="text-xs text-base-content/40 mt-1">
                        {{ notification.created_at|timesince }} temu
                    </p>
                </div>
                {% if not notification.is_read %}
                <div class="flex-shrink-0">
                    <span class="badge badge-primary badge-xs"></span>
                </div>
                {% endif %}
            </div>
        </a>
        {% endfor %}
    {% else %}
    <div class="py-8 text-center text-gray-500">
        <svg class="mx-auto h-8 w-8 mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
        </svg>
        <p class="text-sm">Brak nowych powiadomien</p>
    </div>
    {% endif %}
</div>

{% if notifications %}
<div class="card-actions justify-center pt-2 border-t mt-2">
    <a href="{% url 'notifications:list' %}" class="btn btn-ghost btn-sm">
        Zobacz wszystkie
    </a>
</div>
{% endif %}
