{% extends "admin_panel/base.html" %}

{% block content %}
<div class="space-y-6">
    <h1 class="text-2xl font-bold">Dashboard</h1>

    <!-- Stats Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"
         hx-get="{% url 'admin_panel:stats' %}"
         hx-trigger="every 60s"
         hx-swap="innerHTML">
        {% include "admin_panel/partials/_stats_cards.html" %}
    </div>

    <!-- Main Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Recent Users -->
        <div class="lg:col-span-2">
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Ostatnio dodani uzytkownicy</h2>
                    <div class="overflow-x-auto">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Uzytkownik</th>
                                    <th>Rola</th>
                                    <th>Data</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for user in recent_users %}
                                <tr>
                                    <td>
                                        <div class="flex items-center gap-2">
                                            <div class="avatar placeholder">
                                                <div class="bg-neutral text-neutral-content w-8 rounded-full">
                                                    <span class="text-xs">{{ user.first_name.0 }}{{ user.last_name.0 }}</span>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="font-medium">{{ user.get_full_name }}</div>
                                                <div class="text-xs opacity-50">{{ user.email }}</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="badge badge-sm">{{ user.get_role_display }}</span>
                                    </td>
                                    <td class="text-sm">{{ user.date_joined|date:"d.m.Y" }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="3" class="text-center text-base-content/50">
                                        Brak uzytkownikow
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Upcoming Lessons -->
        <div>
            <div class="card bg-base-100 shadow">
                <div class="card-body">
                    <h2 class="card-title">Nadchodzace zajecia</h2>
                    <ul class="space-y-3">
                        {% for lesson in upcoming_lessons %}
                        <li class="flex items-center gap-3 p-2 rounded-lg hover:bg-base-200">
                            <div class="w-2 h-2 rounded-full" style="background-color: {{ lesson.subject.color|default:'#3B82F6' }}"></div>
                            <div class="flex-1 min-w-0">
                                <div class="font-medium truncate">{{ lesson.title }}</div>
                                <div class="text-xs opacity-60">
                                    {{ lesson.start_time|date:"d.m H:i" }} - {{ lesson.tutor.get_full_name }}
                                </div>
                            </div>
                        </li>
                        {% empty %}
                        <li class="text-center py-4 text-base-content/50">
                            Brak nadchodzacych zajec
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
